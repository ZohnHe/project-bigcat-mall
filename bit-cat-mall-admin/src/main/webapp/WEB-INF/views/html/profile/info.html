<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
    <meta charset="utf-8" />
    <title>我的商城 | 个人信息 </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="Preview page of Metronic Admin Theme #4 for statistics, charts, recent events and reports" name="description" />
    <meta content="" name="author" />
    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
    <!-- END GLOBAL MANDATORY STYLES -->
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <link href="/static/back/assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/morris/morris.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/fullcalendar/fullcalendar.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/global/plugins/jqvmap/jqvmap/jqvmap.css" rel="stylesheet" type="text/css" />
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN THEME GLOBAL STYLES -->
    <link href="/static/back/assets/global/css/components-rounded.min.css" rel="stylesheet" id="style_components" type="text/css" />
    <link href="/static/back/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
    <!-- END THEME GLOBAL STYLES -->
    <!-- BEGIN THEME LAYOUT STYLES -->
    <link href="/static/back/assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/back/assets/layouts/layout4/css/themes/default.min.css" rel="stylesheet" type="text/css" id="style_color" />
    <link href="/static/back/assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
    <!-- END THEME LAYOUT STYLES -->
    <!-- DataTables -->
    <link rel="stylesheet" href="/static/back/assets/plugins/DataTables-1.10.15/media/css/dataTables.bootstrap.min.css">
    <!--sweetalert-->
    <link href="/static/back/assets/global/plugins/bootstrap-sweetalert/sweetalert.css" rel="stylesheet" type="text/css" />
    <!-- iCheck -->
    <link rel="stylesheet" href="/static/back/assets/global/plugins/icheck/skins/all.css">
    <link rel="shortcut icon" href="favicon.ico" /> </head>
<!-- END HEAD -->

<body class="page-container-bg-solid page-header-fixed page-sidebar-closed-hide-logo">
<!-- BEGIN HEADER -->
<div class="page-header navbar navbar-fixed-top">
    <!-- BEGIN HEADER INNER -->
    <div class="page-header-inner ">
        <!-- BEGIN LOGO -->
        <div class="page-logo">
            <a href="/backadmin/main">
                <img src="/static/front/images/logo5.png" style="margin-bottom: 100px" alt="logo" class="logo-default" /> </a>
            <div class="menu-toggler sidebar-toggler">
                <!-- DOC: Remove the above "hide" to enable the sidebar toggler button on header -->
            </div>
        </div>
        <!-- END LOGO -->
        <!-- BEGIN RESPONSIVE MENU TOGGLER -->
        <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a>
        <!-- END RESPONSIVE MENU TOGGLER -->
        <!-- BEGIN PAGE TOP -->
        <div class="page-top">
            <!-- BEGIN HEADER SEARCH BOX -->
            <!-- DOC: Apply "search-form-expanded" right after the "search-form" class to have half expanded search box -->
            <form class="search-form" action="page_general_search_2.html" method="GET">
                <div class="input-group">
                    <input type="text" class="form-control input-sm" placeholder="Search..." name="query">
                    <span class="input-group-btn">
                                <a href="javascript:;" class="btn submit">
                                    <i class="icon-magnifier"></i>
                                </a>
                            </span>
                </div>
            </form>
            <!-- END HEADER SEARCH BOX -->
            <!-- BEGIN TOP NAVIGATION MENU -->
            <div class="top-menu">
                <ul class="nav navbar-nav pull-right">
                    <li class="separator hide"> </li>
                    <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                    <li class="dropdown dropdown-user dropdown-dark">
                        <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                            <span class="username username-hide-on-mobile" id="user-name" ></span>
                            <!-- DOC: Do not remove below empty space(&nbsp;) as its purposely used -->
                            <img alt="" id="user-image"  class="img-circle" src="" /> </a>
                        <ul class="dropdown-menu dropdown-menu-default">
                            <li>
                                <a href="/profile/info">
                                    <i class="icon-user" ></i> 个人信息 </a>
                            </li>
                            <li class="divider"> </li>
                            <li>
                                <a href="#">
                                    <i class="icon-lock"></i> 锁屏 </a>
                            </li>
                            <li>
                                <a href="/user/logout">
                                    <i class="icon-key"></i>注销 </a>
                            </li>
                        </ul>
                    </li>
                    <!-- END USER LOGIN DROPDOWN -->
                </ul>
            </div>
            <!-- END TOP NAVIGATION MENU -->
        </div>
        <!-- END PAGE TOP -->
    </div>
    <!-- END HEADER INNER -->
</div>
<!-- END HEADER -->
<!-- BEGIN HEADER & CONTENT DIVIDER -->
<div class="clearfix"> </div>
<!-- END HEADER & CONTENT DIVIDER -->
<!-- BEGIN CONTAINER -->
<div class="page-container">
    <!-- BEGIN SIDEBAR -->
    <div class="page-sidebar-wrapper">
        <!-- BEGIN SIDEBAR -->
        <div class="page-sidebar navbar-collapse collapse">
            <ul class="page-sidebar-menu   " data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200">
                <li class="nav-item start active open">
                    <a href="javascript:;" class="nav-link nav-toggle">
                        <i class="icon-home"></i>
                        <span class="title">控制面板</span>
                        <span class="selected"></span>
                        <span class="arrow open"></span>
                    </a>
                </li>
                <li class="heading">
                    <h3 class="uppercase">功能菜单</h3>
                </li>
                <li class="nav-item  ">
                    <a href="javascript:;" class="nav-link nav-toggle">
                        <i class="icon-diamond"></i>
                        <span class="title">用户管理</span>
                        <span class="arrow"></span>
                    </a>
                    <ul class="sub-menu">
                        <li class="nav-item  ">
                            <a href="/userx/list" class="nav-link ">
                                <span class="title">用户列表</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item  ">
                    <a href="javascript:;" class="nav-link nav-toggle">
                        <i class="icon-puzzle"></i>
                        <span class="title">商品管理</span>
                        <span class="arrow"></span>
                    </a>
                    <ul class="sub-menu">
                        <li class="nav-item  ">
                            <a href="/item/list" class="nav-link ">
                                <span class="title">商品列表</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item  ">
                    <a href="javascript:;" class="nav-link nav-toggle">
                        <i class="icon-puzzle"></i>
                        <span class="title">订单管理</span>
                        <span class="arrow"></span>
                    </a>
                    <ul class="sub-menu">
                        <li class="nav-item  ">
                            <a href="/order/list" class="nav-link ">
                                <span class="title">订单列表</span>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
            <!-- END SIDEBAR MENU -->
        </div>
        <!-- END SIDEBAR -->
    </div>
    <!-- END SIDEBAR -->
    <!-- BEGIN CONTENT -->
    <div class="page-content-wrapper">
        <!-- BEGIN CONTENT BODY -->
        <div class="page-content">
            <!-- BEGIN PAGE HEAD-->
            <div class="page-head">
                <!-- BEGIN PAGE TITLE -->
                <div class="page-title">
                    <h1>个人信息
                    </h1>
                </div>
                <!-- END PAGE TITLE -->
            </div>
            <!-- END PAGE HEAD-->
            <!-- BEGIN PAGE BREADCRUMB -->
            <ul class="page-breadcrumb breadcrumb">
                <li>
                    <a href="index.html">Home</a>
                    <i class="fa fa-circle"></i>
                </li>
                <li>
                    <span class="active">个人信息</span>
                </li>
            </ul>
            <!-- END PAGE BREADCRUMB -->
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-3">
                        <div class="profile-sidebar">
                            <!-- PORTLET MAIN -->
                            <div class="portlet light profile-sidebar-portlet ">
                                <!-- SIDEBAR USERPIC -->
                                <div class="profile-userpic">
                                    <img id="user-image2" class="img-responsive" alt=""> </div>
                                <!-- END SIDEBAR USERPIC -->
                                <!-- SIDEBAR USER TITLE -->
                                <div class="profile-usertitle">
                                    <div class="profile-usertitle-name"><span id="user_name"></span></div>
                                    <div class="profile-usertitle-job"> 嘿嘿嘿嘿嘿 </div>
                                </div>
                                <!-- END SIDEBAR USER TITLE -->
                                <!-- SIDEBAR BUTTONS -->
                                <div class="profile-userbuttons">
                                    <button type="button" class="btn btn-circle green btn-sm">Follow</button>
                                    <button type="button" class="btn btn-circle red btn-sm">Message</button>
                                </div>
                                <!-- END SIDEBAR BUTTONS -->
                                <!-- SIDEBAR MENU -->
                                <div class="profile-usermenu">
                                    <ul class="nav">
                                        <li>
                                            <a href="#">
                                                <i class="icon-home"></i> 资料卡片 </a>
                                        </li>
                                        <!--<li class="active">-->
                                        <!--<a href="page_user_profile_1_account.html">-->
                                        <!--<i class="icon-settings"></i> Account Settings </a>-->
                                        <!--</li>-->
                                        <!--<li>-->
                                        <!--<a href="page_user_profile_1_help.html">-->
                                        <!--<i class="icon-info"></i> Help </a>-->
                                        <!--</li>-->
                                    </ul>
                                </div>
                                <!-- END MENU -->
                            </div>
                            <!-- END PORTLET MAIN -->
                            <!-- PORTLET MAIN -->

                            <!-- END PORTLET MAIN -->
                        </div>
                    </div>
                    <!-- END BEGIN PROFILE SIDEBAR -->
                    <!-- BEGIN PROFILE CONTENT -->
                            <div class="col-md-9">
                                <div class="portlet light ">
                                    <div class="portlet-title tabbable-line">
                                        <div class="caption caption-md">
                                            <i class="icon-globe theme-font hide"></i>
                                            <span class="caption-subject font-blue-madison bold uppercase">我的资料墙</span>
                                        </div>
                                        <ul class="nav nav-tabs">
                                            <li class="active">
                                                <a href="#tab_1_1" data-toggle="tab">个人信息</a>
                                            </li>
                                            <li>
                                                <a href="#tab_1_2" data-toggle="tab">头像上传</a>
                                            </li>
                                            <li>
                                                <a href="#tab_1_3" data-toggle="tab">修改密码</a>
                                            </li>

                                        </ul>
                                    </div>
                                    <div class="portlet-body">
                                        <div class="tab-content">
                                            <!-- PERSONAL INFO TAB -->
                                            <div class="tab-pane active" id="tab_1_1">
                                                <form role="form" action="#">
                                                    <!--隐藏域-->
                                                    <input type="hidden" id="id-1" name="id" value="" />
                                                    <div class="form-group">
                                                        <label class="control-label">姓名</label>
                                                        <input type="text"  id="username" placeholder="" class="form-control"  required/> </div>
                                                    <div class="form-group">
                                                        <label class="control-label" >电话</label>
                                                        <input type="text" id="phone-1" placeholder="" class="form-control" required /> </div>
                                                    <div class="form-group">
                                                        <label class="control-label">邮箱</label>
                                                        <input type="email"  id="email-1" placeholder="" class="form-control" required/> </div>
                                                    <div class="margiv-top-10">
                                                        <input type="submit" id="save-1" class="btn green" value="保存" />

                                                        <button type="button" class="btn default" onclick="history.go(-1)">返回</button>
                                                    </div>
                                                </form>
                                            </div>
                                            <!-- END PERSONAL INFO TAB -->
                                            <!-- CHANGE AVATAR TAB -->
                                            <div class="tab-pane" id="tab_1_2">
                                                <form action="#" role="form">
                                                    <div class="form-group">
                                                        <input id="imageUser" type="text" class="form-control"  value="" />
                                                        <div class="dropzone dropzone-file-area" id="dropz" >
                                                            <h3 class="sbold">将图片拖到此处或点击上传</h3>
                                                            <p> 点击上传图片 </p>
                                                        </div>
                                                    </div>
                                                    <div class="margin-top-10">
                                                        <input type="button" class="btn green" id="save-3" value="保存" />
                                                        <button type="button" class="btn default" onclick="history.go(-1)">返回</button>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="tab-pane" id="tab_1_3">
                                                <form action="#">
                                                    <!--隐藏域-->
                                                    <div class="form-group">
                                                        <label class="control-label">旧密码</label>
                                                        <input type="password" class="form-control" required="true"/> </div>
                                                    <div class="form-group">
                                                        <label class="control-label">新密码</label>
                                                        <input type="password" id="newPwd" class="form-control" required="true"/> </div>
                                                    <div class="form-group">
                                                        <label class="control-label">重新输入新密码</label>
                                                        <input type="password" class="form-control" requ ired="true"/> </div>
                                                    <div class="margin-top-10">
                                                        <input type="submit" class="btn green" id="save-2" value="保存" />
                                                        <button type="button" class="btn default" onclick="history.go(-1)">返回</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                </div>
            </div>
        </div>
        <!-- END CONTENT BODY -->
    </div>

    <!-- BEGIN QUICK SIDEBAR -->
    <a href="javascript:;" class="page-quick-sidebar-toggler">
        <i class="icon-login"></i>
    </a>

    <!-- END QUICK SIDEBAR -->
</div>
<!-- END CONTAINER -->
<!-- END FOOTER -->
<!-- BEGIN QUICK NAV -->
<div class="quick-nav-overlay"></div>
<!-- END QUICK NAV -->
<!--[if lt IE 9]>
<script src="/static/back/assets/global/plugins/respond.min.js"></script>
<script src="/static/back/assets/global/plugins/excanvas.min.js"></script>
<script src="/static/back/assets/global/plugins/ie8.fix.min.js"></script>
<![endif]-->
<!-- BEGIN CORE PLUGINS -->
<script src="/static/back/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
<!-- END CORE PLUGINS -->
<!-- BEGIN PAGE LEVEL PLUGINS -->
<script src="/static/back/assets/global/plugins/moment.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/morris/morris.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/morris/raphael-min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/counterup/jquery.waypoints.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/counterup/jquery.counterup.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/amcharts.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/serial.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/pie.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/radar.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/themes/light.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/themes/patterns.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amcharts/themes/chalk.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/ammap/ammap.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/ammap/maps/js/worldLow.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/amcharts/amstockcharts/amstock.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/fullcalendar/fullcalendar.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/horizontal-timeline/horizontal-timeline.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/flot/jquery.flot.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/flot/jquery.flot.resize.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/flot/jquery.flot.categories.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jquery-easypiechart/jquery.easypiechart.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jquery.sparkline.min.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/jquery.vmap.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/maps/jquery.vmap.russia.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/maps/jquery.vmap.world.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/maps/jquery.vmap.europe.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/maps/jquery.vmap.germany.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/maps/jquery.vmap.usa.js" type="text/javascript"></script>
<script src="/static/back/assets/global/plugins/jqvmap/jqvmap/data/jquery.vmap.sampledata.js" type="text/javascript"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN THEME GLOBAL SCRIPTS -->
<script src="/static/back/assets/global/scripts/app.min.js" type="text/javascript"></script>
<!-- END THEME GLOBAL SCRIPTS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="/static/back/assets/pages/scripts/dashboard.min.js" type="text/javascript"></script>
<!-- END PAGE LEVEL SCRIPTS -->
<!-- BEGIN THEME LAYOUT SCRIPTS -->
<script src="/static/back/assets/layouts/layout4/scripts/layout.min.js" type="text/javascript"></script>
<script src="/static/back/assets/layouts/layout4/scripts/demo.min.js" type="text/javascript"></script>
<script src="/static/back/assets/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>
<script src="/static/back/assets/layouts/global/scripts/quick-nav.min.js" type="text/javascript"></script>
<!-- END THEME LAYOUT SCRIPTS -->
<!--zTree-->
<script src="https://cdn.bootcss.com/zTree.v3/3.5.33/js/jquery.ztree.core.min.js" type="text/javascript"></script>
<script src="/static/back/assets/js/zTree.js"></script>

<!--dropZone-->
<script src="/static/back/assets/global/plugins/dropzone/dropzone.min.js" type="text/javascript"></script>
<!--wangEditor-->
<script src="https://cdn.bootcss.com/wangEditor/3.1.1/wangEditor.min.js"></script>
<script>
    //显示信息
    $(document).ready(
        function () {
            $.ajax({
                type:"post",
                url:"/backadmin/getMsg",
                dataType:"json",
                success:function (data) {
                    var json = data;
                    $("#user-name").html(json.username);
                    $("#id-1").val(json.id);
                    $("#username").val(json.username);
                    $("#phone-1").val(json.phone);
                    $("#email-1").val(json.email);
                    $("#user-image").attr("src",json.image);
                    $("#user-image2").attr("src",json.image);
                }
            })
        }
    )
    //禁用Dropzone的自动发现行为
    Dropzone.autoDiscover = false;
    var myDropzone = new Dropzone("#dropz", {
        url: "/upload",//上传到哪个页面
        dictDefaultMessage: "拖动文件至此或者点击上传",//设置默认的提示语句
        paramName: "dropzFile",//传到后台的参数名称
        maxFilesize: 3,//最大上次数量
        init: function() {
            //成功后，将路径信息的值传递到对应id中
            this.on("success", function (file, data) {
                $("#imageUser").val(data.fileName);
            });
        }
    });
    //基本信息修改
    $("#save-1").click(function () {
        // debugger
        var id =$("#id-1").val();
        var username = $("#username").val();
        var phone = $("#phone-1").val();
        var email = $("#email-1").val();
        //修改
        $.ajax({
            type:"post",
            url:"/profile/save",
            data:{id:id,username:username,phone:phone,email:email},
            dataType:"json",
            success:function (data) {
                var json = data;
                if(json == "1"){
                    window.location.href="/backuser/login";
                }
            }
        });
    })

    //头像修改
    $("#save-3").click(function () {
        var id =$("#id-1").val();
        var image = $("#imageUser").val();
        //修改
        $.ajax({
            type:"post",
            url:"/profile/save",
            data:{id:id,image:image},
            dataType:"json",
            success:function (data) {
                var json = data;
                if(json == "1"){
                    window.location.href="/backuser/login";
                }
            }
        });
    })


    //修改密码
    $("#save-2").click(function () {
        var id =$("#id-1").val();
        var username = $("#name-1").val();
        var password = $("#newPwd").val();
        var salt;
        //设置为同步请求，以免后面的 ajax 先执行
        $.ajaxSettings.async = false;
        //获取后台的盐值
        $.get("/user/salt?loginId=" + username,function (data) {
            if(data != null){
                salt = data;
            }
        })
        //密码加盐
        password = $.md5(password);
        password = $.md5(password + salt);
        //修改
        $.ajax({
            type:"post",
            url:"/profile/save",
            data:{id:id,password:password},
            dataType:"json",
            success:function (data) {
                var json = data;
                if(json == "1"){
                    window.location.href="/user/login";
                }
            }
        });
    })


</script>
</body>

</html>